<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Math Test - MathauraX</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #195acd 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .test-section {
            padding: 30px;
            border-bottom: 1px solid #eee;
        }
        
        .test-section:last-child {
            border-bottom: none;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #195acd;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .test-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            border-color: #195acd;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(25, 90, 205, 0.1);
        }
        
        .test-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 10px;
            transition: border-color 0.3s ease;
        }
        
        .test-input:focus {
            outline: none;
            border-color: #195acd;
        }
        
        .test-button {
            background: linear-gradient(135deg, #195acd 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(25, 90, 205, 0.3);
        }
        
        .test-button:active {
            transform: translateY(0);
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .quick-test {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .quick-test-item {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quick-test-item:hover {
            background: #bbdefb;
            transform: scale(1.05);
        }
        
        .status-bar {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .status-success {
            color: #28a745;
        }
        
        .status-error {
            color: #dc3545;
        }
        
        .status-pending {
            color: #ffc107;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-test {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üßÆ MathauraX Comprehensive Test</h1>
            <p>Testing all mathematical functions to ensure perfect functionality</p>
        </div>

        <div class="test-section">
            <h2 class="section-title">üìä System Status</h2>
            <div class="status-bar">
                <div class="status-item status-pending">
                    <span>üîÑ</span>
                    <span>Initializing...</span>
                </div>
                <div class="status-item status-pending">
                    <span>üìö</span>
                    <span>Math Engine: Loading...</span>
                </div>
                <div class="status-item status-pending">
                    <span>üåê</span>
                    <span>APIs: Loading...</span>
                </div>
                <div class="status-item status-pending">
                    <span>‚úÖ</span>
                    <span>Tests: Pending...</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 0%"></div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">üî¢ Basic Operations Test</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Square Root</h3>
                    <input type="text" class="test-input" id="sqrtInput" placeholder="e.g., square root of 16">
                    <button class="test-button" onclick="testFunction('sqrt')">Test Square Root</button>
                    <div id="sqrtResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Basic Arithmetic</h3>
                    <input type="text" class="test-input" id="arithmeticInput" placeholder="e.g., 5 plus 3">
                    <button class="test-button" onclick="testFunction('arithmetic')">Test Arithmetic</button>
                    <div id="arithmeticResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Factorial</h3>
                    <input type="text" class="test-input" id="factorialInput" placeholder="e.g., factorial of 5">
                    <button class="test-button" onclick="testFunction('factorial')">Test Factorial</button>
                    <div id="factorialResult" class="result"></div>
                </div>
            </div>
            
            <div class="quick-test">
                <div class="quick-test-item" onclick="quickTest('square root of 16')">
                    <strong>‚àö16</strong><br>
                    <small>Should be 4</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('5 plus 3')">
                    <strong>5 + 3</strong><br>
                    <small>Should be 8</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('factorial of 5')">
                    <strong>5!</strong><br>
                    <small>Should be 120</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('25 percent of 80')">
                    <strong>25% of 80</strong><br>
                    <small>Should be 20</small>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">üîç Number Theory Test</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Prime Numbers</h3>
                    <input type="text" class="test-input" id="primeInput" placeholder="e.g., is 17 prime">
                    <button class="test-button" onclick="testFunction('prime')">Test Prime</button>
                    <div id="primeResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>GCD (Greatest Common Divisor)</h3>
                    <input type="text" class="test-input" id="gcdInput" placeholder="e.g., gcd of 48 and 18">
                    <button class="test-button" onclick="testFunction('gcd')">Test GCD</button>
                    <div id="gcdResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>LCM (Least Common Multiple)</h3>
                    <input type="text" class="test-input" id="lcmInput" placeholder="e.g., lcm of 12 and 15">
                    <button class="test-button" onclick="testFunction('lcm')">Test LCM</button>
                    <div id="lcmResult" class="result"></div>
                </div>
            </div>
            
            <div class="quick-test">
                <div class="quick-test-item" onclick="quickTest('is 17 prime')">
                    <strong>Prime(17)</strong><br>
                    <small>Should be true</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('gcd of 48 and 18')">
                    <strong>GCD(48,18)</strong><br>
                    <small>Should be 6</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('lcm of 12 and 15')">
                    <strong>LCM(12,15)</strong><br>
                    <small>Should be 60</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('is 15 prime')">
                    <strong>Prime(15)</strong><br>
                    <small>Should be false</small>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">üìà Statistics Test</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Mean (Average)</h3>
                    <input type="text" class="test-input" id="meanInput" placeholder="e.g., mean of 2, 4, 6, 8">
                    <button class="test-button" onclick="testFunction('mean')">Test Mean</button>
                    <div id="meanResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Median</h3>
                    <input type="text" class="test-input" id="medianInput" placeholder="e.g., median of 1, 3, 5, 7, 9">
                    <button class="test-button" onclick="testFunction('median')">Test Median</button>
                    <div id="medianResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Mode</h3>
                    <input type="text" class="test-input" id="modeInput" placeholder="e.g., mode of 1, 2, 2, 3, 4">
                    <button class="test-button" onclick="testFunction('mode')">Test Mode</button>
                    <div id="modeResult" class="result"></div>
                </div>
            </div>
            
            <div class="quick-test">
                <div class="quick-test-item" onclick="quickTest('mean of 2, 4, 6, 8')">
                    <strong>Mean(2,4,6,8)</strong><br>
                    <small>Should be 5</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('median of 1, 3, 5, 7, 9')">
                    <strong>Median(1,3,5,7,9)</strong><br>
                    <small>Should be 5</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('mode of 1, 2, 2, 3, 4')">
                    <strong>Mode(1,2,2,3,4)</strong><br>
                    <small>Should be 2</small>
                </div>
                <div class="quick-test-item" onclick="quickTest('mean of 10, 20, 30')">
                    <strong>Mean(10,20,30)</strong><br>
                    <small>Should be 20</small>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">üßÆ Advanced Operations Test</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Derivatives</h3>
                    <input type="text" class="test-input" id="derivativeInput" placeholder="e.g., derivative of x^2">
                    <button class="test-button" onclick="testFunction('derivative')">Test Derivative</button>
                    <div id="derivativeResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Matrix Determinant</h3>
                    <input type="text" class="test-input" id="determinantInput" placeholder="e.g., determinant of [[1,2],[3,4]]">
                    <button class="test-button" onclick="testFunction('determinant')">Test Determinant</button>
                    <div id="determinantResult" class="result"></div>
                </div>
                
                <div class="test-card">
                    <h3>Custom Expression</h3>
                    <input type="text" class="test-input" id="customInput" placeholder="e.g., 2^3 + sqrt(16)">
                    <button class="test-button" onclick="testFunction('custom')">Test Expression</button>
                    <div id="customResult" class="result"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2 class="section-title">üöÄ Automated Test Suite</h2>
            <div class="test-card">
                <h3>Run All Tests</h3>
                <p>This will test all mathematical functions automatically and report any issues.</p>
                <button class="test-button" onclick="runAllTests()">Run Complete Test Suite</button>
                <button class="test-button" onclick="debugTest()" style="margin-top: 10px; background: #dc3545;">Debug Test</button>
                <button class="test-button" onclick="simpleTest()" style="margin-top: 10px; background: #28a745;">Simple Test</button>
                <div id="allTestsResult" class="result"></div>
            </div>
        </div>
    </div>

    <script src="scripts/math-engine.js"></script>
    <script src="scripts/math-apis.js"></script>
    <script src="scripts/response.js"></script>
    
    <script>
        // Define the missing appendMessage function
        function appendMessage(message, sender) {
            // For testing purposes, we'll return the message directly
            // In a real chat interface, this would append to a chat container
            return message;
        }
        // Global variables
        let mathEngine;
        let mathAPIs;
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0
        };

        // Initialize the system
        window.addEventListener('load', async function() {
            updateStatus('Initializing...', 'pending');
            
            try {
                // Initialize MathEngine
                if (typeof MathauraXEngine !== 'undefined') {
                    mathEngine = new MathauraXEngine();
                    updateStatus('Math Engine: Ready', 'success');
                } else {
                    updateStatus('Math Engine: Failed', 'error');
                }

                // Initialize MathAPIs
                if (typeof MathauraXAPIs !== 'undefined') {
                    mathAPIs = new MathauraXAPIs();
                    updateStatus('APIs: Ready', 'success');
                } else {
                    updateStatus('APIs: Failed', 'error');
                }

                updateStatus('System: Ready', 'success');
                updateProgress(100);
                
                // Run initial tests
                setTimeout(() => {
                    runInitialTests();
                }, 1000);
                
            } catch (error) {
                console.error('Initialization error:', error);
                updateStatus('System: Error', 'error');
            }
        });

        function updateStatus(message, type) {
            const statusItems = document.querySelectorAll('.status-item');
            statusItems.forEach(item => {
                if (item.textContent.includes('üîÑ') || item.textContent.includes('Loading...')) {
                    item.innerHTML = `<span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : 'üîÑ'}</span><span>${message}</span>`;
                    item.className = `status-item status-${type}`;
                }
            });
        }

        function updateProgress(percentage) {
            const progressFill = document.querySelector('.progress-fill');
            progressFill.style.width = percentage + '%';
        }

        async function testFunction(type) {
            const inputId = type + 'Input';
            const resultId = type + 'Result';
            const input = document.getElementById(inputId).value;
            const resultDiv = document.getElementById(resultId);
            
            if (!input) {
                resultDiv.innerHTML = '<div class="error">Please enter a value to test.</div>';
                return;
            }

            resultDiv.innerHTML = '<div class="info">Testing...</div>';
            
            try {
                const response = await generateResponse(input);
                // Extract the actual response content
                const responseContent = response.replace(/<[^>]*>/g, ''); // Remove HTML tags for display
                resultDiv.innerHTML = `<div class="success">‚úÖ <strong>Input:</strong> ${input}<br><strong>Result:</strong> ${responseContent}</div>`;
                testResults.passed++;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå <strong>Input:</strong> ${input}<br><strong>Error:</strong> ${error.message}</div>`;
                testResults.failed++;
            }
            
            testResults.total++;
        }

        async function quickTest(query) {
            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.innerHTML = `<div class="info">Testing: "${query}"</div>`;
            
            try {
                const response = await generateResponse(query);
                // Extract the actual response content
                const responseContent = response.replace(/<[^>]*>/g, ''); // Remove HTML tags for display
                resultDiv.innerHTML = `<div class="success">‚úÖ <strong>Query:</strong> "${query}"<br><strong>Result:</strong> ${responseContent}</div>`;
                testResults.passed++;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå <strong>Query:</strong> "${query}"<br><strong>Error:</strong> ${error.message}</div>`;
                testResults.failed++;
            }
            
            testResults.total++;
        }

        async function runInitialTests() {
            const tests = [
                'square root of 16',
                '5 plus 3',
                'factorial of 5',
                'is 17 prime',
                'lcm of 12 and 15',
                'mean of 2, 4, 6, 8'
            ];

            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.innerHTML = '<div class="info">Running initial tests...</div>';

            for (let test of tests) {
                try {
                    const response = await generateResponse(test);
                    testResults.passed++;
                    console.log(`Test passed for "${test}":`, response);
                } catch (error) {
                    testResults.failed++;
                    console.error(`Test failed for "${test}":`, error);
                }
                testResults.total++;
            }

            resultDiv.innerHTML = `<div class="success">‚úÖ Initial tests completed!<br>Passed: ${testResults.passed}, Failed: ${testResults.failed}</div>`;
        }

        async function runAllTests() {
            const comprehensiveTests = [
                // Basic operations
                'square root of 16',
                'cube root of 27',
                '5 plus 3',
                '10 minus 4',
                '6 times 7',
                '20 divided by 4',
                'factorial of 5',
                '25 percent of 80',
                '2 raised to 3',
                '3 squared',
                '4 cubed',
                
                // Number theory
                'is 17 prime',
                'is 15 prime',
                'gcd of 48 and 18',
                'lcm of 12 and 15',
                'lcm of 6 and 8',
                'lcm of 24 and 36',
                
                // Statistics
                'mean of 2, 4, 6, 8',
                'median of 1, 3, 5, 7, 9',
                'mode of 1, 2, 2, 3, 4',
                'mean of 10, 20, 30',
                
                // Advanced
                'derivative of x^2',
                'determinant of [[1,2],[3,4]]',
                '2^3 + sqrt(16)',
                
                // Edge cases
                'square root of -4',
                'factorial of -1',
                'mean of',
                'is 1 prime'
            ];

            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.innerHTML = '<div class="info">Running comprehensive test suite...</div>';

            let passed = 0;
            let failed = 0;
            let results = [];

            for (let test of comprehensiveTests) {
                try {
                    const response = await generateResponse(test);
                    // Extract the actual response content
                    const responseContent = response.replace(/<[^>]*>/g, ''); // Remove HTML tags for display
                    passed++;
                    results.push(`‚úÖ ${test}: PASSED - ${responseContent.substring(0, 50)}...`);
                } catch (error) {
                    failed++;
                    results.push(`‚ùå ${test}: FAILED - ${error.message}`);
                }
            }

            const summary = `Test Suite Complete!<br>Total: ${comprehensiveTests.length}<br>Passed: ${passed}<br>Failed: ${failed}<br>Success Rate: ${((passed/comprehensiveTests.length)*100).toFixed(1)}%`;
            
            resultDiv.innerHTML = `
                <div class="${failed === 0 ? 'success' : 'error'}">
                    <h3>${summary}</h3>
                    <details>
                        <summary>Detailed Results</summary>
                        <div style="max-height: 300px; overflow-y: auto; margin-top: 10px;">
                            ${results.join('<br>')}
                        </div>
                    </details>
                </div>
            `;
        }

        // Test direct function calls
        function testDirectFunctions() {
            if (!mathEngine) {
                console.log('MathEngine not available');
                return;
            }
            
            console.log('Testing direct function calls:');
            console.log('LCM(12, 15) =', mathEngine.calculateLCM(12, 15));
            console.log('GCD(48, 18) =', mathEngine.calculateGCD(48, 18));
            console.log('Mean([2, 4, 6, 8]) =', mathEngine.calculateMean([2, 4, 6, 8]));
        }

        // Debug function to test generateResponse directly
        async function debugTest() {
            console.log('Testing generateResponse function...');
            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.innerHTML = '<div class="info">Running debug test...</div>';
            
            try {
                const result = await generateResponse('lcm of 12 and 15');
                console.log('generateResponse result:', result);
                resultDiv.innerHTML = `<div class="success">‚úÖ Debug test passed!<br><strong>Result:</strong> ${result}</div>`;
                return result;
            } catch (error) {
                console.error('generateResponse error:', error);
                resultDiv.innerHTML = `<div class="error">‚ùå Debug test failed!<br><strong>Error:</strong> ${error.message}</div>`;
                return null;
            }
        }

        // Simple test function that doesn't rely on complex system
        function simpleTest() {
            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.innerHTML = '<div class="info">Running simple test...</div>';
            
            try {
                // Test basic math functions directly
                const lcm = mathEngine ? mathEngine.calculateLCM(12, 15) : 'MathEngine not available';
                const gcd = mathEngine ? mathEngine.calculateGCD(48, 18) : 'MathEngine not available';
                const sqrt = Math.sqrt(16);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        ‚úÖ Simple test results:<br>
                        ‚Ä¢ LCM(12, 15) = ${lcm}<br>
                        ‚Ä¢ GCD(48, 18) = ${gcd}<br>
                        ‚Ä¢ ‚àö16 = ${sqrt}
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Simple test failed: ${error.message}</div>`;
            }
        }

        // Run direct function tests after initialization
        window.addEventListener('load', function() {
            setTimeout(() => {
                testDirectFunctions();
            }, 2000);
        });
    </script>
</body>
<script type="module" src="scripts/auth.js"></script>

</html> 